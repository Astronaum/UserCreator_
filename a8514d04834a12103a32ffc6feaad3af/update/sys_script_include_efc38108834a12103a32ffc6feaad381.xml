<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_script_include">
    <sys_script_include action="INSERT_OR_UPDATE">
        <access>public</access>
        <active>true</active>
        <api_name>x_1539348_usercre.CreateSCIMUser</api_name>
        <caller_access/>
        <client_callable>true</client_callable>
        <description/>
        <mobile_callable>false</mobile_callable>
        <name>CreateSCIMUser</name>
        <sandbox_callable>false</sandbox_callable>
        <script><![CDATA[var CreateSCIMUser = Class.create();
CreateSCIMUser.prototype = {
    initialize: function() {},
    
    // This method is called from the GlideAjax call to create a user
    createUser: function(username, displayname, email) {
        try {
            // Log the data for debugging
            gs.info("Creating SCIM User with the following details:");
            gs.info("Username: " + username);
            gs.info("Displayname: " + displayname);
            gs.info("Email: " + email);

            // Create the user record (replace 'sys_user' with your specific table if needed)
            var userRec = new GlideRecord('user_requests');
            userRec.initialize();
            userRec.username = username;
			gs.info(username + " i m here");
            userRec.displayname = displayname;
            userRec.email = email;
            userRec.insert();  // Insert the user record

            // Schedule a script to run asynchronously
            var scheduledJob = new GlideRecord('scheduled_script_log');
			gs.info(scheduledJob + " i dont get here");
            scheduledJob.initialize();
            scheduledJob.script = 'CreateSCIMUserScheduledScript'; // The name of your scheduled script
            scheduledJob.arguments = JSON.stringify({ username: username, displayname: displayname, email: email });
            scheduledJob.insert();

            return "User creation triggered successfully!";
        } catch (e) {
            return "Error creating user: " + e.message;
        }
    },

    type: 'CreateSCIMUser'
};
]]></script>
        <sys_class_name>sys_script_include</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2024-11-18 15:41:32</sys_created_on>
        <sys_id>efc38108834a12103a32ffc6feaad381</sys_id>
        <sys_mod_count>16</sys_mod_count>
        <sys_name>CreateSCIMUser</sys_name>
        <sys_package display_value="UserCreator1.2" source="x_1539348_usercre">a8514d04834a12103a32ffc6feaad3af</sys_package>
        <sys_policy/>
        <sys_scope display_value="UserCreator1.2">a8514d04834a12103a32ffc6feaad3af</sys_scope>
        <sys_update_name>sys_script_include_efc38108834a12103a32ffc6feaad381</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2024-11-19 11:17:55</sys_updated_on>
    </sys_script_include>
    <sys_es_latest_script action="INSERT_OR_UPDATE">
        <id>efc38108834a12103a32ffc6feaad381</id>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2024-11-18 15:41:32</sys_created_on>
        <sys_id>58048108834a12103a32ffc6feaad386</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2024-11-18 15:41:32</sys_updated_on>
        <table>sys_script_include</table>
        <use_es_latest>true</use_es_latest>
    </sys_es_latest_script>
</record_update>
